"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[449],{8985:function(e,t,n){n.d(t,{b:function(){return u}});var a=n(5893),r=n(7294),s=n(1163),o=n(471),i=n(1355),c=n(4413),l=n(2767),d=n(7733);function u(e){var t,n,u=e.schema,p=e.formFactor,m=e.permissions,f=(0,s.useRouter)(),h=f.query,v=h.app_id,b=h.tab_id,g=h.record_id,x=(0,r.useState)(null),y=x[0],j=x[1],S=(0,r.useState)(null),w=S[0],I=S[1],N=function(){var e=d.Z.listView.editRecordMode;SteedosUI.Object.editRecord({appId:v,name:SteedosUI.getRefId({type:"".concat(e,"-form")}),title:"\u7f16\u8f91 ".concat(u.uiSchema.label),objectName:u.uiSchema.name,recordId:g,type:e,options:{props:{width:"100%",style:{width:"100%"},bodyStyle:{padding:"0px",paddingTop:"0px"}}},router:f,formFactor:p,onSubmitted:function(){SteedosUI.getRef(SteedosUI.getRefId({type:"detail",appId:v,name:u.uiSchema.name})).getComponentById("detail_".concat(g)).reload()}})};return(0,r.useEffect)((function(){u&&(!function(e){var t=[];e&&e.uiSchema&&(null===m||void 0===m?void 0:m.allowEdit)&&t.push({label:"\u7f16\u8f91",name:"edit",todo:N}),t=_.concat(t,(0,c.vU)(e.uiSchema,{app_id:v,tab_id:b,router:f})),t=_.concat(t,(0,c.ud)(e.uiSchema,{app_id:v,tab_id:b,router:f})),I(t)}(u),window.addEventListener("message",(function(e){var t=e.data;if("record.loaded"===t.type){var n=t.record;j(n)}})))}),[u]),(0,a.jsx)("div",{className:"slds-page-header slds-page-header_record-home shadow-none border-none bg-slate-50",children:(0,a.jsxs)("div",{className:"slds-page-header__row",children:[(0,a.jsx)("div",{className:"slds-page-header__col-title",children:(0,a.jsxs)("div",{className:"slds-media",children:[(0,a.jsx)("div",{className:"slds-media__figure",children:(0,a.jsx)("span",{className:"slds-icon_container slds-icon-standard-opportunity",children:(0,a.jsx)("svg",{className:"slds-icon slds-page-header__icon","aria-hidden":"true",children:(0,a.jsx)("use",{xlinkHref:"/assets/icons/standard-sprite/svg/symbols.svg#".concat(u.uiSchema.icon)})})})}),(0,a.jsx)("div",{className:"slds-media__body",children:(0,a.jsx)("div",{className:"slds-page-header__name",children:(0,a.jsx)("div",{className:"slds-page-header__name-title",children:(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)("span",{children:null===u||void 0===u||null===(t=u.uiSchema)||void 0===t?void 0:t.label}),(0,a.jsx)("span",{className:"slds-page-header__title slds-truncate",children:y?y[null===u||void 0===u||null===(n=u.uiSchema)||void 0===n?void 0:n.NAME_FIELD_KEY]:""})]})})})})]})}),(0,a.jsx)("div",{className:"slds-page-header__col-actions",children:(0,a.jsx)("div",{className:"slds-page-header__controls",children:(0,a.jsx)("div",{className:"slds-page-header__control",children:(0,a.jsx)("ul",{className:"slds-button-group-list",children:(0,a.jsx)(a.Fragment,{children:(null===w||void 0===w?void 0:w.length)>0&&(0,a.jsx)("li",{children:(0,a.jsxs)(o.v,{as:"div",className:"slds-dropdown-trigger slds-dropdown-trigger_click",children:[(0,a.jsx)("div",{children:(0,a.jsx)(o.v.Button,{className:"border-0",children:(0,a.jsx)("div",{children:(0,a.jsx)("svg",{className:"slds-icon slds-icon-text-default slds-icon_x-small","aria-hidden":"true",children:(0,a.jsx)("use",{xlinkHref:"/assets/icons/utility-sprite/svg/symbols.svg#threedots_vertical"})})})})}),(0,a.jsx)(i.u,{as:r.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,a.jsx)(o.v.Items,{className:"absolute right-0 z-10 mt-1 w-56 origin-top-right divide-y divide-gray-100 bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:rounded-[2px]",children:(0,a.jsx)("div",{className:"",children:null===w||void 0===w?void 0:w.map((function(e,t){return(0,a.jsx)(o.v.Item,{children:function(t){var n=t.active;return(0,a.jsx)(l.z,{button:e,inMore:!0,data:{app_id:v,tab_id:b,object_name:u.uiSchema.name},className:"".concat(n?"bg-violet-500 text-white":"text-gray-900"," slds-dropdown__item group flex w-full items-center border-0 px-2 py-2")})}},t)}))})})})]})})})})})})})]})})}},2767:function(e,t,n){n.d(t,{z:function(){return c}});var a=n(6042),r=n(5893),s=n(3796),o=n(4413),i=n(1163);function c(e){var t=(0,i.useRouter)(),n=e.button,c=e.data,l=e.className,d=e.scopeClassName,u=e.inMore,p=c.dataComponentId;if("amis_action"===n.type){var m={type:"service",bodyClassName:"p-0",body:[{type:"button",label:n.label,className:"".concat(u?"flex w-full items-center border-0 px-2 py-1":"bg-white"," ").concat(l||""),onEvent:{click:{actions:JSON.parse(n.amis_actions)}}}],regions:["body"],data:(0,a.Z)({},c)};return(0,r.jsx)(s.k,{id:SteedosUI.getRefId({type:"button",appId:c.app_id,name:n.name}),schema:m,router:t,className:d})}return(0,r.jsx)("button",{onClick:function(){return(0,o.ht)(n,Object.assign({},c,{scope:SteedosUI.getRef(p)}))},className:"antd-Button antd-Button--default ".concat(l||""),children:n.label})}},2917:function(e,t,n){n.d(t,{b:function(){return u}});var a=n(5893),r=n(7294),s=n(1163),o=n(471),i=n(1355),c=n(4413),l=n(2767),d=n(7733);function u(e){var t,n,u=e.schema,p=e.formFactor,m=e.permissions,f=(0,s.useRouter)(),h=f.query,v=h.app_id,b=h.tab_id,g=h.record_id,x=(0,r.useState)(null),_=x[0],y=x[1],j=(0,r.useState)(null),S=j[0],w=j[1],I=(0,r.useState)(null),N=I[0],T=I[1];return(0,r.useEffect)((function(){u&&(!function(e){e&&e.uiSchema&&(w((0,c.vU)(e.uiSchema,{app_id:v,tab_id:b,router:f})),T((0,c.ud)(e.uiSchema,{app_id:v,tab_id:b,router:f})))}(u),window.addEventListener("message",(function(e){var t=e.data;if("record.loaded"===t.type){var n=t.record;y(n)}})))}),[u]),(0,a.jsx)("div",{className:"slds-page-header slds-page-header_record-home bg-transparent shadow-none border-none pb-0",children:(0,a.jsxs)("div",{className:"slds-page-header__row",children:[(0,a.jsx)("div",{className:"slds-page-header__col-title",children:(0,a.jsxs)("div",{className:"slds-media",children:[(0,a.jsx)("div",{className:"slds-media__figure",children:(0,a.jsx)("span",{className:"slds-icon_container slds-icon-standard-opportunity",children:(0,a.jsx)("svg",{className:"slds-icon slds-page-header__icon","aria-hidden":"true",children:(0,a.jsx)("use",{xlinkHref:"/assets/icons/standard-sprite/svg/symbols.svg#".concat(u.uiSchema.icon)})})})}),(0,a.jsx)("div",{className:"slds-media__body",children:(0,a.jsx)("div",{className:"slds-page-header__name",children:(0,a.jsx)("div",{className:"slds-page-header__name-title",children:(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)("span",{children:null===u||void 0===u||null===(t=u.uiSchema)||void 0===t?void 0:t.label}),(0,a.jsx)("span",{className:"slds-page-header__title slds-truncate",children:_?_[null===u||void 0===u||null===(n=u.uiSchema)||void 0===n?void 0:n.NAME_FIELD_KEY]:""})]})})})})]})}),(0,a.jsx)("div",{className:"slds-page-header__col-actions",children:(0,a.jsx)("div",{className:"slds-page-header__controls",children:(0,a.jsxs)("div",{className:"slds-page-header__control space-x-1",children:[(null===m||void 0===m?void 0:m.allowEdit)&&(0,a.jsx)("button",{onClick:function(){var e=d.Z.listView.editRecordMode;SteedosUI.Object.editRecord({appId:v,name:SteedosUI.getRefId({type:"".concat(e,"-form")}),title:"\u7f16\u8f91 ".concat(u.uiSchema.label),objectName:u.uiSchema.name,recordId:g,type:e,options:{},router:f,onSubmitted:function(){SteedosUI.getRef(SteedosUI.getRefId({type:"detail",appId:v,name:u.uiSchema.name})).getComponentById("detail_".concat(g)).reload()},formFactor:p})},className:"antd-Button antd-Button--default",children:"\u7f16\u8f91"}),(0,a.jsxs)(a.Fragment,{children:[null===S||void 0===S?void 0:S.map((function(e){return(0,a.jsx)(l.z,{button:e,data:{app_id:v,tab_id:b,object_name:u.uiSchema.name,dataComponentId:"".concat(v,"-").concat(b,"-").concat(g)},scopeClassName:"inline-block"},e.name)})),(null===N||void 0===N?void 0:N.length)>0&&(0,a.jsxs)(o.v,{as:"div",className:"slds-dropdown-trigger slds-dropdown-trigger_click",children:[(0,a.jsx)("div",{children:(0,a.jsx)(o.v.Button,{className:"slds-button slds-button_icon-border-filled slds-button_last",children:(0,a.jsx)("div",{children:(0,a.jsx)("svg",{focusable:"false","data-key":"down","aria-hidden":"true",className:"slds-button__icon",children:(0,a.jsx)("use",{xlinkHref:"/assets/icons/utility-sprite/svg/symbols.svg#down"})})})})}),(0,a.jsx)(i.u,{as:r.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,a.jsx)(o.v.Items,{className:"absolute right-0 z-10 mt-1 w-56 origin-top-right divide-y divide-gray-100 bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:rounded-[2px]",children:(0,a.jsx)("div",{className:"",children:N.map((function(e,t){return(0,a.jsx)(o.v.Item,{children:function(t){var n=t.active;return(0,a.jsx)(l.z,{button:e,inMore:!0,data:{app_id:v,tab_id:b,object_name:u.uiSchema.name},className:"".concat(n?"bg-violet-500 text-white":"text-gray-900"," slds-dropdown__item group flex w-full items-center border-0 px-2 py-2")})}},t)}))})})})]})]})]})})})]})})}},5125:function(e,t,n){n.d(t,{B:function(){return p}});var a=n(4924),r=n(5893),s=n(4413),o=n(1163),i=n(7294),c=n(2767),l=n(3796),d=n(8282),u=n(7733);function p(e){var t,n,p=e.app_id,m=e.tab_id,f=e.schema,h=e.refId,v=e.foreign_key,b=e.record_id,g=e.object_name,x=e.masterObjectName,_=e.inMore,y=e.formFactor,j=(0,i.useState)(null),S=j[0],w=j[1],I=(0,o.useRouter)();(0,i.useEffect)((function(){f&&f.uiSchema&&w((0,s.Iv)(f.uiSchema,{app_id:p,tab_id:m,router:I}))}),[f]);var N=(0,d.Z0)(),T={type:"page",bodyClassName:"p-0",body:[{type:"form",title:"\u8868\u5355",body:[{type:"input-file",label:"",name:"file",id:"u:a58d02614e04",btnLabel:"\u4e0a\u4f20",btnClassName:"m-0",multiple:!1,maxLength:10,submitType:"asUpload",uploadType:"fileReceptor",proxy:!1,drag:!1,autoUpload:!0,useChunk:!1,joinValues:!1,extractValue:!1,valueField:"version_id",receiver:{url:"${context.rootUrl}/s3",headers:{Authorization:"Bearer ${context.tenantId},${context.authToken}"},method:"post",messages:{},dataType:"form-data",requestAdaptor:"\n                        api.data.append('record_id', '".concat(b,"');\n                        api.data.append('object_name', '").concat(x,"');\n                        api.data.append('space', '").concat(N.spaceId,"');\n                        api.data.append('owner', '").concat(N.userId,"');\n                        api.data.append('owner_name', '").concat(N.name,"');\n                        return api;\n                      ")},onEvent:{success:{weight:0,actions:[{componentId:"u:5f901c0b917b",args:{},actionType:"clear"},{componentId:"",args:{msgType:"success",position:"top-right",closeButton:!0,showIcon:!0,msg:"\u4e0a\u4f20\u6210\u529f"},actionType:"toast"},{componentId:"",args:{},actionType:"custom",script:"\n                                SteedosUI.getRef('".concat(h,"').getComponentByName('page.listview_").concat(g,'\').handleAction({}, { actionType: "reload"})\n                            ')}]}}}],id:"u:5f901c0b917b",wrapWithPanel:!1}],regions:["body"],data:{}};return(0,r.jsx)(r.Fragment,{children:(null===f||void 0===f?void 0:f.uiSchema)&&(0,r.jsxs)(r.Fragment,{children:[(null===f||void 0===f||null===(t=f.uiSchema)||void 0===t||null===(n=t.permissions)||void 0===n?void 0:n.allowCreate)&&(0,r.jsxs)(r.Fragment,{children:["cms_files"!=f.uiSchema.name&&(0,r.jsx)("button",{onClick:function(){if("cms_files"===f.uiSchema.name);else{var e=u.Z.listView.newRecordMode;SteedosUI.Object.newRecord({onSubmitted:function(){SteedosUI.getRef(h).getComponentByName("page.listview_".concat(f.uiSchema.name)).handleAction({},{actionType:"reload"})},onCancel:function(){SteedosUI.getRef(h).getComponentByName("page.listview_".concat(f.uiSchema.name)).handleAction({},{actionType:"reload"})},data:{data:(0,a.Z)({},v,b)},appId:p,name:SteedosUI.getRefId({type:"".concat(e,"-form"),appId:p,name:"".concat(f.uiSchema.name)}),title:"\u65b0\u5efa ".concat(f.uiSchema.label),objectName:f.uiSchema.name,recordId:"new",type:e,formFactor:y,options:"SMALL"===y?{props:{width:"100%",style:{width:"100%"},bodyStyle:{padding:"0px",paddingTop:"0px"}}}:{},router:I})}},className:_?"flex w-full items-center border-0 px-2 py-1":"slds-button slds-button_neutral",children:"\u65b0\u5efa"}),"cms_files"===f.uiSchema.name&&(0,r.jsx)(l.k,{id:SteedosUI.getRefId({type:"button",appId:p,name:"upload"}),schema:T,router:I,className:"inline-block"})]}),null===S||void 0===S?void 0:S.map((function(e){return(0,r.jsx)(c.z,{button:e,inMore:_,data:{app_id:p,tab_id:m,object_name:f.uiSchema.name,dataComponentId:SteedosUI.getRefId({type:"listview",appId:p,name:f.uiSchema.name})},className:_?"flex items-center border-0 px-2 py-1":"",scopeClassName:"inline-block"},e.name)}))]})})}},4413:function(e,t,n){n.d(t,{ht:function(){return m},Iv:function(){return d},vU:function(){return u},ud:function(){return p}});var a=n(6486),r=n.n(a),s="__G_L_O_B_A_L__",o=function(e){var t;return"string"===typeof e?1===(t=e.split(".")).length?"#":(t.pop(),t.join(".")):"#"},i=function(e,t){return"#"!==t&&t?"string"===typeof t?a.get(e,t):void console.error("path has to be a string"):e||{}},c=function(e,t){if(e._visible&&(r().startsWith(r().trim(e._visible),"function")?(window.eval("var fun = "+e._visible),e.visible=fun):function(e){var t,n,a;return"string"===typeof e&&(t=/^{{(.+)}}$/,n=/^{{(function.+)}}$/,a=/^{{(.+=>.+)}}$/,!("string"!==typeof e||!e.match(t)||e.match(n)||e.match(a)))}(e._visible)&&(e.visible=function(t){!function(e,t,n,a){var r,c,l,d,u,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(void 0===t&&(t={}),d=o(n),l=i(t,d)||{},"string"!==typeof e)return e;c=e.substring(2,e.length-2),u="\n  var $user=".concat(JSON.stringify(p),";   return ")+c.replace(/\bformData\b/g,JSON.stringify(t).replace(/\bglobal\b/g,s)).replace(/\bglobal\b/g,JSON.stringify(a)).replace(new RegExp("\\b"+s+"\\b","g"),"global").replace(/rootValue/g,JSON.stringify(l));try{Function(u)()}catch(m){return r=m,console.log(r,e,n),e}}(e._visible,t.record,"#",{now:new Date},t.userSession)})),!r().isFunction(e.visible))return e.visible;try{return e.visible(t)}catch(n){}},l=function(e,t){var n=e.permissions.disabled_actions,a=r().sortBy(r().values(e.actions),"sort");return r().has(e,"allow_customActions")&&(a=r().filter(a,(function(t){return r().include(e.allow_customActions,t.name)}))),r().has(e,"exclude_actions")&&(a=r().filter(a,(function(t){return!r().include(e.exclude_actions,t.name)}))),r().each(a,(function(e){t.isMobile&&["record","record_only"].indexOf(e.on)>-1&&"standard_edit"!=e.name&&("record_only"==e.on?e.on="record_only_more":e.on="record_more")})),t.isMobile&&["cms_files","cfs.files.filerecord"].indexOf(e.name)>-1&&r().map(a,(function(e){"standard_edit"===e.name&&(e.on="record_more"),"download"===e.name&&(e.on="record")})),r().filter(a,(function(e){return r().indexOf(n,e.name)<0}))},d=function(e,t){var n=l(e,t);return r().filter(n,(function(e){return"list"==e.on&&c(e,t)}))},u=function(e,t){var n=l(e,t);return r().filter(n,(function(e){return("record"==e.on||"record_only"==e.on)&&c(e,t)}))},p=function(e,t){var n=l(e,t);return r().filter(n,(function(e){return("record_more"==e.on||"record_only_more"==e.on)&&c(e,t)}))},m=function(e,t){if(e.todo)return r().isString(e.todo)&&r().startsWith(r().trim(e.todo),"function")&&(window.eval("var fun = "+e.todo),e.todo=fun),r().isFunction(e.todo)?e.todo.apply({},[t]):void 0}},237:function(e,t,n){n.d(t,{Q:function(){return l},r:function(){return c}});var a=n(7568),r=n(4051),s=n.n(r),o=n(8282),i=n(6486),c=function(){var e=(0,a.Z)(s().mark((function e(t,n){var a,r,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],(0,i.each)(n,(function(e){a.push("".concat(e.object_name,": ").concat(e.object_name,'__count(filters: [["').concat(e.foreign_key,'","=","').concat(t,'"]])'))})),r="\n    {\n        ".concat(a.join(","),"\n    }\n    "),e.next=5,(0,o.Io)("/graphql",{method:"POST",body:JSON.stringify({query:r})});case 5:return c=e.sent,e.abrupt("return",c.data);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=(0,a.Z)(s().mark((function e(t,n){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.Io)("/service/api/@".concat(t,"/recordPermissions/").concat(n),{method:"GET"});case 2:return a=e.sent,console.log("result",a),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},9808:function(e,t,n){n.d(t,{O:function(){return O}});var a=n(7294),r=n(2351),s=n(9946),o=n(2984),i=n(1363),c=n(4575),l=n(6723),d=n(3784),u=n(4157),p=n(3855),m=n(6045);function f({onFocus:e}){let[t,n]=(0,a.useState)(!0);return t?a.createElement(m._,{as:"button",type:"button",features:m.A.Focusable,onFocus:t=>{t.preventDefault();let a,r=50;a=requestAnimationFrame((function t(){if(!(r--<=0))return e()?(n(!1),void cancelAnimationFrame(a)):void(a=requestAnimationFrame(t));a&&cancelAnimationFrame(a)}))}}):null}var h,v=n(3781),b=((h=b||{})[h.SetSelectedIndex=0]="SetSelectedIndex",h[h.RegisterTab=1]="RegisterTab",h[h.UnregisterTab=2]="UnregisterTab",h[h.RegisterPanel=3]="RegisterPanel",h[h.UnregisterPanel=4]="UnregisterPanel",h[h.ForceRerender=5]="ForceRerender",h);let g={0(e,t){let n=e.tabs.filter((e=>{var t;return!(null!=(t=e.current)&&t.hasAttribute("disabled"))}));if(t.index<0)return{...e,selectedIndex:e.tabs.indexOf(n[0])};if(t.index>e.tabs.length)return{...e,selectedIndex:e.tabs.indexOf(n[n.length-1])};let a=e.tabs.slice(0,t.index),r=[...e.tabs.slice(t.index),...a].find((e=>n.includes(e)));return r?{...e,selectedIndex:e.tabs.indexOf(r)}:e},1:(e,t)=>e.tabs.includes(t.tab)?e:{...e,tabs:(0,c.z2)([...e.tabs,t.tab],(e=>e.current))},2:(e,t)=>({...e,tabs:(0,c.z2)(e.tabs.filter((e=>e!==t.tab)),(e=>e.current))}),3:(e,t)=>e.panels.includes(t.panel)?e:{...e,panels:[...e.panels,t.panel]},4:(e,t)=>({...e,panels:e.panels.filter((e=>e!==t.panel))}),5:e=>({...e})},x=(0,a.createContext)(null);function _(e){let t=(0,a.useContext)(x);if(null===t){let t=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,_),t}return t}x.displayName="TabsSSRContext";let y=(0,a.createContext)(null);function j(e){let t=(0,a.useContext)(y);if(null===t){let t=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,j),t}return t}y.displayName="TabsDataContext";let S=(0,a.createContext)(null);function w(e){let t=(0,a.useContext)(S);if(null===t){let t=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,w),t}return t}function I(e,t){return(0,o.E)(t.type,g,e,t)}S.displayName="TabsActionsContext";let N=a.Fragment,T=(0,r.yV)((function(e,t){let{defaultIndex:n=0,vertical:s=!1,manual:o=!1,onChange:i,selectedIndex:c=null,...u}=e;const m=s?"vertical":"horizontal",h=o?"manual":"auto";let v=(0,d.T)(t),[b,g]=(0,a.useReducer)(I,{selectedIndex:null!=c?c:n,tabs:[],panels:[]}),_=(0,a.useMemo)((()=>({selectedIndex:b.selectedIndex})),[b.selectedIndex]),j=(0,p.E)(i||(()=>{})),w=(0,p.E)(b.tabs),T=(0,a.useMemo)((()=>({orientation:m,activation:h,...b})),[m,h,b]),R=(0,p.E)(b.selectedIndex),k=(0,a.useMemo)((()=>({registerTab:e=>(g({type:1,tab:e}),()=>g({type:2,tab:e})),registerPanel:e=>(g({type:3,panel:e}),()=>g({type:4,panel:e})),forceRerender(){g({type:5})},change(e){R.current!==e&&j.current(e),R.current=e,g({type:0,index:e})}})),[g]);(0,l.e)((()=>{g({type:0,index:null!=c?c:n})}),[c]);let E=(0,a.useRef)({tabs:[],panels:[]}),P={ref:v};return a.createElement(x.Provider,{value:E},a.createElement(S.Provider,{value:k},a.createElement(y.Provider,{value:T},T.tabs.length<=0&&a.createElement(f,{onFocus:()=>{var e,t;for(let n of w.current)if(0===(null==(e=n.current)?void 0:e.tabIndex))return null==(t=n.current)||t.focus(),!0;return!1}}),(0,r.sY)({ourProps:P,theirProps:u,slot:_,defaultTag:N,name:"Tabs"}))))})),R=(0,r.yV)((function(e,t){let{orientation:n,selectedIndex:a}=j("Tab.List"),s=(0,d.T)(t);return(0,r.sY)({ourProps:{ref:s,role:"tablist","aria-orientation":n},theirProps:e,slot:{selectedIndex:a},defaultTag:"div",name:"Tabs.List"})})),k=(0,r.yV)((function(e,t){var n,p;let m=`headlessui-tabs-tab-${(0,s.M)()}`,{orientation:f,activation:h,selectedIndex:b,tabs:g,panels:x}=j("Tab"),y=w("Tab"),S=_("Tab"),I=(0,a.useRef)(null),N=(0,d.T)(I,t,(e=>{!e||y.forceRerender()}));(0,l.e)((()=>y.registerTab(I)),[y,I]);let T=S.current.tabs.indexOf(m);-1===T&&(T=S.current.tabs.push(m)-1);let R=g.indexOf(I);-1===R&&(R=T);let k=R===b,E=(0,v.z)((e=>{let t=g.map((e=>e.current)).filter(Boolean);if(e.key===i.R.Space||e.key===i.R.Enter)return e.preventDefault(),e.stopPropagation(),void y.change(R);switch(e.key){case i.R.Home:case i.R.PageUp:return e.preventDefault(),e.stopPropagation(),(0,c.jA)(t,c.TO.First);case i.R.End:case i.R.PageDown:return e.preventDefault(),e.stopPropagation(),(0,c.jA)(t,c.TO.Last)}return(0,o.E)(f,{vertical:()=>e.key===i.R.ArrowUp?(0,c.jA)(t,c.TO.Previous|c.TO.WrapAround):e.key===i.R.ArrowDown?(0,c.jA)(t,c.TO.Next|c.TO.WrapAround):void 0,horizontal:()=>e.key===i.R.ArrowLeft?(0,c.jA)(t,c.TO.Previous|c.TO.WrapAround):e.key===i.R.ArrowRight?(0,c.jA)(t,c.TO.Next|c.TO.WrapAround):void 0})?e.preventDefault():void 0})),P=(0,v.z)((()=>{var e;null==(e=I.current)||e.focus()})),F=(0,v.z)((()=>{var e;null==(e=I.current)||e.focus(),y.change(R)})),O=(0,v.z)((e=>{e.preventDefault()})),A=(0,a.useMemo)((()=>({selected:k})),[k]),C=e,U={ref:N,onKeyDown:E,onFocus:"manual"===h?P:F,onMouseDown:O,onClick:F,id:m,role:"tab",type:(0,u.f)(e,I),"aria-controls":null==(p=null==(n=x[R])?void 0:n.current)?void 0:p.id,"aria-selected":k,tabIndex:k?0:-1};return(0,r.sY)({ourProps:U,theirProps:C,slot:A,defaultTag:"button",name:"Tabs.Tab"})})),E=(0,r.yV)((function(e,t){let{selectedIndex:n}=j("Tab.Panels"),s=(0,d.T)(t),o=(0,a.useMemo)((()=>({selectedIndex:n})),[n]);return(0,r.sY)({ourProps:{ref:s},theirProps:e,slot:o,defaultTag:"div",name:"Tabs.Panels"})})),P=r.AN.RenderStrategy|r.AN.Static,F=(0,r.yV)((function(e,t){var n,o;let{selectedIndex:i,tabs:c,panels:u}=j("Tab.Panel"),p=w("Tab.Panel"),m=_("Tab.Panel"),f=`headlessui-tabs-panel-${(0,s.M)()}`,h=(0,a.useRef)(null),v=(0,d.T)(h,t,(e=>{!e||p.forceRerender()}));(0,l.e)((()=>p.registerPanel(h)),[p,h]);let b=m.current.panels.indexOf(f);-1===b&&(b=m.current.panels.push(f)-1);let g=u.indexOf(h);-1===g&&(g=b);let x=g===i,y=(0,a.useMemo)((()=>({selected:x})),[x]),S=e,I={ref:v,id:f,role:"tabpanel","aria-labelledby":null==(o=null==(n=c[g])?void 0:n.current)?void 0:o.id,tabIndex:x?0:-1};return(0,r.sY)({ourProps:I,theirProps:S,slot:y,defaultTag:"div",features:P,visible:x,name:"Tabs.Panel"})})),O=Object.assign(k,{Group:T,List:R,Panels:E,Panel:F})}}]);